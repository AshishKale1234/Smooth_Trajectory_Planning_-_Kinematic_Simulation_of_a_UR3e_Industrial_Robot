# Smooth Trajectory Planning & Kinematic Simulation of a UR3e Industrial Robot

This project implements smooth trajectory generation and full kinematic control for a UR3e robotic arm. A custom end-effector trajectory is generated, mapped to joint space using Forward and Inverse Kinematics (Product of Exponentials), exported to CSV, and verified in ROS 2 using RViz.

## Project Overview
- Custom Lissajous trajectory with trapezoidal velocity profile
- Forward Kinematics (Space & Body formulations)
- Iterative Inverse Kinematics using the Body Jacobian
- Singularity and joint smoothness verification
- ROS 2 + RViz visualization using CSV-based joint playback
- LED on/off control for light-painting trajectories

## Repository Structure
```
.
├── MATLAB/
│   ├── Lab4.m              # Main trajectory + FK/IK + CSV export
│   ├── Lab4_Bonus.m        # Bonus trajectory with LED control
│   ├── functions/          # Modern Robotics utility functions
│   └── tests/              # Test benches for FK/IK utilities
│
├── ws4/src/
│   ├── msee22_description/ # UR3e robot + room description
│   ├── py_joint_pub/       # CSV-based joint publisher node
│   ├── table_description/ # Table environment
│   └── wall_description/  # Wall environment
│
├── 0039367426.csv          # Generated joint trajectory
├── 0039367426_bonus.csv   # Bonus trajectory (LED on/off)
└── README.md
```

## Prerequisites
### MATLAB
- MATLAB (R2021a or newer recommended)
- No external toolboxes required

### ROS 2 (for visualization)
- Ubuntu 22.04
- ROS 2 Humble (or Jazzy)
- colcon build tools

## Running the MATLAB Code
1. Open MATLAB and set the repository root as the working directory.
2. Add the `MATLAB/` folder (and subfolders) to the MATLAB path.
3. Run:
   - `Lab4.m` for the main trajectory
   - `Lab4_Bonus.m` for the bonus trajectory

This generates plots and exports a CSV with the format:
```
time, joint1, joint2, joint3, joint4, joint5, joint6, led
```

## Visualizing in RViz (ROS 2)
1. Build the workspace:
```bash
cd ws4
colcon build --symlink-install
source install/setup.bash
```

2. Launch the UR3e environment:
```bash
ros2 launch msee22_description view_room.launch.py
```

3. Copy a CSV into the joint publisher resource folder:
```bash
cp ../0039367426.csv src/py_joint_pub/py_joint_pub/resource/
```

4. In:
```
ws4/src/py_joint_pub/py_joint_pub/joint_publisher_csv.py
```
set the filename to match your CSV and build and source again.

5. Run the robot motion:
```bash
ros2 launch msee22_description move_robot.launch.py
```

6. Enable the tool0 trace in RViz to visualize the trajectory.

## Notes
- Do **not** commit `ws4/build`, `ws4/install`, or `ws4/log` (generated by colcon).
- Joint smoothness and singularity avoidance are verified via MATLAB plots.
- The bonus trajectory demonstrates LED-controlled light painting.

## Credits
- ECE 569: Intro to Robotics (Purdue University)
- Modern Robotics (Product of Exponentials, Jacobian-based IK)
- Universal Robots ROS 2 Description Packages
